{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Code: clang-format-13 my changes",
            "type": "shell",
            "command": "PS4='$ '; git-clang-format-13 --binary clang-format-13",
            "problemMatcher": []
        },
        {
            "label": "Code: clang-format-13 endless-sky master",
            "type": "shell",
            "command": "PS4='$ '; set -ex; git fetch https://github.com/endless-sky/endless-sky.git master; git-clang-format-13 --binary clang-format-13 --commit $(git merge-base FETCH_HEAD HEAD)",
            "problemMatcher": []
        },
        {
            "label": "Code: Merge upstream ES master",
            "type": "shell",
            "command": "PS4='$ '; if ! git diff-index --quiet HEAD --; then tput setaf 1; echo 'ERROR: Commit or stash your changes before proceeding.' >&2; tput sgr 0; exit 1;fi;set -ex; git fetch https://github.com/endless-sky/endless-sky.git master; if git merge-base --is-ancestor FETCH_HEAD HEAD; then set +x;tput setaf 2; echo 'Nothing to do!  You are up to date with endless-sky master.'; tput sgr 0; else git merge --no-ff FETCH_HEAD -m \"Merge branch 'master' into $(git symbolic-ref --short HEAD)\"; set +x;tput setaf 2; echo 'Success!  Your branch has been updated with endless-sky master.'; tput sgr 0; fi",
            "problemMatcher": []
        },
        {
            "label": "Build: Compile Endless Sky OpenGL Desktop",
            "type": "shell",
            "command": "PS4='$ '; set -ex; scons -Qj $(nproc) opengl=desktop mode=debug",
            "problemMatcher": [],
            "group": {
                "kind": "build",
                "isDefault": true
            }
        },
        {
            "label": "Build: Clean and Reset Workspace",
            "type": "shell",
            "command": "PS4='$ '; set -x; scons -c; scons -c tests; rm -f *.AppImage endless-sky.png; git checkout credits.txt",
            "problemMatcher": [],
            "group": {
                "kind": "build",
                "isDefault": false
            }
        },
        {
            "label": "Test: Run tests",
            "type": "shell",
            "command": "PS4='$ '; set -ex; scons -Qj $(nproc) test",
            "problemMatcher": [],
            "group": {
                "kind": "test",
                "isDefault": false
            }
        },
        {
            "label": "Test: Run benchmarks",
            "type": "shell",
            "command": "PS4='$ '; if [ ! -x ./tests/endless-sky-tests ]; then tput setaf 1; echo 'Execute `Build: Run tests` first...' >&2; tput sgr 0; exit 1; fi; set -ex; ./tests/endless-sky-tests '[!benchmark]'",
            "problemMatcher": [],
            "group": {
                "kind": "test",
                "isDefault": false
            }
        },
        {
            "label": "Test: Run headless integration tests",
            "type": "shell",
            "command": "PS4='$ '; set -ex; export PRINT_GLXINFO=true;  ./tests/run_tests_headless.sh",
            "problemMatcher": [],
            "group": {
                "kind": "test",
                "isDefault": false
            }
        },
        {
            "label": "Package: Reset AppImage Continuous",
            "type": "shell",
            "command": "PS4='$ '; set -e; for x in XCode/EndlessSky-Info.plist credits.txt endless-sky.6 source/main.cpp; do ( set -x; git checkout \"$x\"; ); done; set -x; rm -f *.AppImage",
            "problemMatcher": []
        },
        {
            "label": "Package: AppImage Continuous",
            "type": "shell",
            "command": "PS4='$ '; if ! git diff --exit-code credits.txt; then tput setaf 1; echo 'credits.txt has changes according to Git.  Reset it or commit before proceeding.' >&2; tput sgr 0; exit 1; fi; set -ex; ./utils/cd_update_versions.sh; ./utils/build_appimage.sh",
            "problemMatcher": []
        }
    ]
}
